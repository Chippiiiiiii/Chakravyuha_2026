<!DOCTYPE html>
<html>
<head>
    <title>Team Auction</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<h2>Team Auction Panel</h2>

<input id="teamInput" placeholder="Enter Team Name">
<button onclick="join()">Join</button>

<h3 id="basePrice"></h3>
<h3 id="timer"></h3>

<p>Your Capital: ₹<span id="capital">0</span></p>
<p>Your Bid: ₹<span id="myBid">0</span></p>

<input type="number" id="bidInput">
<button onclick="placeBid()">Increase Bid</button>

<h2 id="result"></h2>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    let myTeamId = null;
    let endTime = null;

    function join() {
      myTeamId = document.getElementById("teamInput").value;
      socket.emit("joinTeam", myTeamId);
    }

    function placeBid() {
      const amount = parseInt(document.getElementById("bidInput").value);
      socket.emit("placeBid", { teamId: myTeamId, amount });
    }

    socket.on("updateCapital", (capital) => {
      document.getElementById("capital").innerText = capital;
    });

    socket.on("capitalUpdated", ({ teamId, capital }) => {
      if (teamId === myTeamId) {
        document.getElementById("capital").innerText = capital;
      }
    });

    socket.on("auctionStarted", (data) => {
      document.getElementById("basePrice").innerText =
        "Base Price: ₹" + data.basePrice;

      document.getElementById("result").innerText = "";
      document.getElementById("myBid").innerText = data.basePrice;

      endTime = data.endTime;
    });

    socket.on("updateBid", (amount) => {
      document.getElementById("myBid").innerText = amount;
    });

    socket.on("auctionEnded", ({ winner, highest }) => {
      document.getElementById("result").innerText =
        "Auction Ended! Highest Bid: ₹" + highest + " | Winner: " + winner;
    });

    setInterval(() => {
      if (endTime) {
        const remaining = Math.max(0,
          Math.floor((endTime - Date.now()) / 1000));
        document.getElementById("timer").innerText =
          "Time Left: " + remaining + "s";
      }
    }, 1000);

</script>

</body>
</html>
